v1:
DROP VIEW IF EXISTS v_active_employees CASCADE;
CREATE VIEW v_active_employees AS
SELECT
  employee_id, first_name, last_name, email, phone, hire_date,
  department_id, position_id, manager_id, active, created_at
FROM employee
WHERE active = TRUE
WITH CHECK OPTION;

v2:
DROP VIEW IF EXISTS v_oncall_shifts_valid CASCADE;
CREATE VIEW v_oncall_shifts_valid AS
SELECT
  shift_id, employee_id, day_of_week, start_time, end_time,
  escalation_order, created_at
FROM oncall_shift
WHERE day_of_week BETWEEN 0 AND 6
  AND start_time < end_time
WITH CHECK OPTION;


v3:
DROP VIEW IF EXISTS v_current_licenses CASCADE;
CREATE VIEW v_current_licenses AS
SELECT
  el.license_id,
  el.employee_id,
  (e.first_name || ' ' || e.last_name) AS employee,
  el.license_name,
  el.issued_date,
  el.expiry_date
FROM employee_license el
JOIN employee e ON e.employee_id = el.employee_id
WHERE el.expiry_date >= CURRENT_DATE;

v4:
DROP VIEW IF EXISTS v_employee_overview CASCADE;
CREATE VIEW v_employee_overview AS
SELECT
  e.employee_id,
  (e.first_name || ' ' || e.last_name) AS full_name,
  d.name  AS department,
  p.title AS position,
  (SELECT COUNT(*) FROM payroll pr WHERE pr.employee_id = e.employee_id) AS payments_count
FROM employee e
LEFT JOIN department d ON d.department_id = e.department_id
LEFT JOIN position   p ON p.position_id   = e.position_id;
